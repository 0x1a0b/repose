buildscript {
    repositories {
        mavenCentral()
        jcenter()
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }

    dependencies {
        classpath 'org.unbroken-dome.gradle-plugins:gradle-testsets-plugin:1.2.0'
        classpath 'com.netflix.nebula:gradle-extra-configurations-plugin:3.0.3'
    }
}

repositories {
    mavenCentral()
    maven {
        url "https://maven.research.rackspacecloud.com/content/groups/aggregate/"
    }
}

group = 'com.rackspace.lefty'
def baseVersion = '1.0.0'
version = project.hasProperty('release') ? baseVersion : "$baseVersion-SNAPSHOT"

apply plugin: 'java'
apply plugin: 'groovy'
apply plugin: 'org.unbroken-dome.test-sets'
apply plugin: 'nebula.provided-base'
apply plugin: 'checkstyle'
apply plugin: 'codenarc'
apply plugin: 'jacoco'
apply plugin: 'idea'

dependencies {
}

testSets {
    integrationTest
}

check.dependsOn integrationTest
integrationTest.mustRunAfter test

sourceCompatibility = 1.8
targetCompatibility = 1.8

checkstyle {
    configFile = file("$rootDir/config/styles/checkstyle.xml")
    sourceSets = sourceSets.matching {it.name != 'generated'}
}

codenarc {
    configFile = file("$rootDir/config/styles/codenarc.xml")
}

jacoco {
    toolVersion = "0.7.6.201602180812"
}

test {
    jacoco {
        destinationFile = file("$rootDir/build/jacoco/jacocoTest.exec")
    }
}

integrationTest {
    jacoco {
        destinationFile = file("$rootDir/build/jacoco/jacocoIntegrationTest.exec")
    }
    systemProperty 'jacocoArguments', jacoco.getAsJvmArg()
}
