<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE book [
<!-- product name is likely to change; parameterize full name, abbreviated name, expanded name -->
<!ENTITY PRODNAME "Repose">
<!ENTITY PRODABBREV "Repose">
<!ENTITY PRODEXPAND "REstful PrOxy Service Engine">
    <!-- Some useful entities borrowed from HTML -->
    <!ENTITY ndash  "&#x2013;">
    <!ENTITY mdash  "&#x2014;">
    <!ENTITY hellip "&#x2026;">

    <!-- Useful for describing APIs -->
    <!ENTITY GET    '<command xmlns="http://docbook.org/ns/docbook">GET</command>'>
    <!ENTITY PUT    '<command xmlns="http://docbook.org/ns/docbook">PUT</command>'>
    <!ENTITY POST   '<command xmlns="http://docbook.org/ns/docbook">POST</command>'>
    <!ENTITY DELETE '<command xmlns="http://docbook.org/ns/docbook">DELETE</command>'>

    <!ENTITY CHECK  '<inlinemediaobject xmlns="http://docbook.org/ns/docbook">
        <imageobject>
        <imagedata fileref="img/Check_mark_23x20_02.svg"
        format="SVG" scale="60"/>
        </imageobject>
        </inlinemediaobject>'>

    <!ENTITY ARROW  '<inlinemediaobject xmlns="http://docbook.org/ns/docbook">
        <imageobject>
        <imagedata fileref="img/Arrow_east.svg"
        format="SVG" scale="60"/>
        </imageobject>
        </inlinemediaobject>'>
]>
<!-- in BOOK below, add status="draft" to set watermark on cover and left margin -->
<book version="5.0" xmlns="http://docbook.org/ns/docbook"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      xmlns:svg="http://www.w3.org/2000/svg"
      xmlns:m="http://www.w3.org/1998/Math/MathML"
      xmlns:html="http://www.w3.org/1999/xhtml"
      xml:id="repose-components-deploy.xml">
    <?rax pdf.url="../../repose-logging-deploy.pdf"?>
    <title>&PRODNAME; Component Reference Guide</title>
    <!-- set watermark on cover and left margin 
        <?rax status.bar.text="CONFIDENTIAL"?>
    -->
    <?rax title.font.size="35px" subtitle.font.size="16px"?>
    <titleabbrev>&PRODABBREV; Component Reference Guide</titleabbrev>
    <info>
        <author>
            <personname>
                <firstname/>
                <surname/>
            </personname>
            <affiliation>
                <orgname>Rackspace Cloud</orgname>
            </affiliation>
        </author>
        <copyright>
            <year>2010</year>
            <year>2011</year>
            <year>2012</year>
            <holder>Rackspace US, Inc.</holder>
        </copyright>
        <releaseinfo>v1.0</releaseinfo>
        <productname>&PRODNAME;</productname>
        <pubdate>2013-11-12</pubdate>
        <legalnotice role="apache2">
            <annotation>
                <remark>Copyright details are filled in by the template.</remark>
            </annotation>
        </legalnotice>
        <abstract>
            <para>This document is intended for systems administrators interested in configuring
                their service to use the components of &PRODEXPAND;. </para>
        </abstract>
        <revhistory>
            <revision>
                <date>2013-11-12</date>
                <revdescription>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>Initial release.</para>
                        </listitem>
                    </itemizedlist>
                </revdescription>
            </revision>
        </revhistory>
    </info>
    <chapter xml:id="Overview-d1e85">
        <title>About This Document</title>
            <para>The purpose of this handbook is to facilitate
            deployment of &PRODNAME; components. This handbook is not
            a tutorial. It provides basic information that will help
            you understand and deploy &PRODNAME; components, but you
            must adapt this information to suit your own
            configuration. </para>
            
        <section xml:id="Document_Change_History-d1e102">
            <title>Document Change History</title>
            <para>This version of the handbook replaces and obsoletes all previous versions.
                The most recent changes are described in the table below: </para>
            <?rax revhistory?>
        </section>
       <xi:include href="chapters/available-doc.xml"/> 
    </chapter>
    
   <!-- FILTER ORDER --> 
   <xi:include href="chapters/repose-filterorder-chapter.xml"/> 
    
 
   <!-- REQUEST-RESPONSE MODIFICATION FILTERS --> 
    
    <chapter xml:id="request-response-modification-filters">
        <title>Request-Response Modification Filters</title>
        <para>The Request-Response Modification filters modify requests or responses in various ways. 
            Use these filters remove or modify the headers, the query parameters, or the body of requests and responses. 
            To see the basic functions that these filters perform, read through each filter description in 
            the table below.</para>
        
        <table rules="all" frame="box" border="1">
            <?dbfo keep-together="always"?>
            <caption>Request-Response Modification Filters</caption>
            <thead>
                <tr>
                    <td>Filter Name</td>
                    <td>filter-name</td>
                    <td>XML Schema Definition</td>
                    <td>Example Configuration</td>
                    <td>Description</td>
                   
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <para>
                            <link linkend="Header-Normalization-Chapter">Header Normalization</link>
                        </para>
                        
                    </td> 
                    <td>
                        
                        <para>
                            header-normalization
                        </para>
                    </td>
                    
                    <td>
                        <link xlink:href="https://github.com/rackerlabs/repose/blob/master/repose-aggregator/components/filters/header-normalization/src/main/resources/META-INF/schema/config/header-normalization-configuration.xsd"> 
                            header-normalization.xsd</link>
                        
                    </td>
                    <td>
                        <link xlink:href="https://github.com/rackerlabs/repose/blob/master/repose-aggregator/components/filters/header-normalization/src/main/resources/META-INF/schema/examples/header-normalization.cfg.xml"> 
                            header-normalization.cfg.xml</link>  
                    </td>
                    <td>
                        <para>Cleans the request to prevent unexpected request headers.</para>
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <para>
                            <link linkend="Repose-Content-Normalization-Chapter">Content Normalization</link>
                        </para>
                        
                    </td> 
                    <td>
                        <para>content-normalization</para>
                    </td>
                    <td>
                        
                        <link xlink:href="https://github.com/rackerlabs/repose/blob/master/repose-aggregator/components/filters/content-normalization/src/main/resources/META-INF/schema/config/normalization-configuration.xsd"> 
                            content-normalization.xsd</link>  
                    </td>
                    <td>
                        <link xlink:href="https://github.com/rackerlabs/repose/blob/master/repose-aggregator/components/filters/content-normalization/src/main/resources/META-INF/schema/examples/content-normalization.cfg.xml"> 
                            content-normalization.cfg.xml</link> 
                    </td>
                    <td>
                        <para>Allows normalization of the headers and
                            media-type of the request.</para>
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <para>
                            <link linkend="uri-normalization-chapter">Content Normalization</link>
                        </para>
                        
                    </td> 
                    
                    <td>
                        <para>uri-normalization</para>
                    </td>
                    <td>
                        <para>uri-normalization.xsd</para>
                    </td>
                    <td>
                        
                            <para>uri-normalization.cfg.xml</para> 
                    </td>
                    <td>
                        <para>Allows normalization of a request's
                            query parameters and media type. </para>
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <para>
                            <link linkend="Repose-Header-Translation-Chapter">Header Translation</link>
                        </para>
                    </td>
                    <td>
                        <para>header-translation</para>
                    </td>
                    <td>
                        <link xlink:href="https://github.com/rackerlabs/repose/blob/master/repose-aggregator/components/filters/header-translation/src/main/resources/META-INF/schema/config/header-translation.xsd"> 
                            header-translation.xsd</link>  
                    </td>
                    <td>
                        <link xlink:href="https://github.com/rackerlabs/repose/blob/master/repose-aggregator/components/filters/header-translation/src/main/resources/META-INF/schema/config/header-translation.xsd"> 
                            header-translation.xsd</link> 
                    </td>
                    <td>
                        <para>Translates a request header to one or
                            many other headers. There is an option to
                            remove the original header or leave it in
                            place. </para>
                    </td>
                </tr>
                
                <tr>
                    <td><para><link linkend="Repose-Translation-Chapter"
                        >Translation</link></para></td>
                    <td>
                        <para>translation</para>
                    </td>
                    <td>
                        <link xlink:href="https://github.com/rackerlabs/repose/blob/master/repose-aggregator/components/filters/header-translation/src/main/resources/META-INF/schema/config/header-translation.xsd"> 
                            translation.xsd</link> 
                    </td>
                    <td>
                        <link xlink:href="https://github.com/rackerlabs/repose/blob/master/repose-aggregator/components/filters/translation/src/main/resources/META-INF/schema/examples/translation.cfg.xml"> 
                            translation.cfg.xml</link> 
                    </td>
                    <td>
                        <para>Translates requests and responses so
                            that services receive the request in the
                            expected format and the responses are
                            returned to the client in the expected
                            format. </para>
                    </td>
                </tr>
                
                <tr>
                    <td>URI Stripper</td>
                    <td>
                        <para>uri-stripper</para>
                    </td>
                    <td>
                        <para>uri-stripper.xsd</para>
                    </td>
                    <td>
                        <para>uri-stripper.cfg.xml</para>
                    </td>
                    <td>
                        <para>Strips out a specific section of the
                            request URI and edits the Location if
                            there is one present in the response. </para>
                    </td>
                </tr>
                
            </tbody>
        </table>
                
        
    <xi:include href="chapters/repose-content_normalization-chapter.xml"/> 
    <xi:include href="chapters/repose-uri-normalization.xml"/> 
    <xi:include href="chapters/repose-header-normalization-chapter.xml"/>
    <xi:include href="chapters/repose-header_translation-chapter.xml"/>
    <xi:include href="chapters/repose-translation-chapter.xml"/>
    </chapter>
    
   
   
    <!-- RATELIMITING MODIFICATION FILTERS --> 
    
    <chapter xml:id="ratelimiting-filters">
        <title>Ratelimiting Filters and Filters Commonly Used with Rate Limiting</title>
        <para>The Ratelimiting filter gives you configurable control to rate-limit requests that are set by the Identity filters. 
            Use the Identity filters to introspect request headers and source IPs and to set X-PP-User and X-PP-Groups 
            headers. To see the basic functions that these filters perform, read through each filter description in the 
            table below.</para>
        <table rules="all" frame="box" border="1">
            <?dbfo keep-together="always"?>
            <caption>Request-Response Modification Filters</caption>
            <thead>
                <tr>
                    <td>Filter Name</td>
                    <td>filter-name</td>
                    <td>XML Schema Definition</td>
                    <td>Example Configuration</td>
                    <td>Description</td>
                    
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <para>Header Identity</para>
                    </td>
                    <td>
                        <para>header-identity</para>
                    </td>
                    <td>
                        <para>header-identity-configuration.xsd</para>
                    </td>
                    <td>
                        <para>header-identity.cfg.xml</para>
                    </td>
                    <td>
                        <para>Enables Repose to introspect a
                            configured header and set the X-PP-User
                            and X-PP-Groups headers accordingly. </para>
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <para>Header Identity Mapping</para>
                    </td>
                    <td>
                        <para>header-id-mapping</para>
                    </td>
                    <td>
                        <para>header-id-mapping-configuration.xsd</para>
                    </td>
                    <td>
                        <para>header-id-mapping.cfg.xml</para>
                    </td>
                    <td>Enables Repose to  introspect a configured
                        header and set the X-PP-User and X-PP-Groups
                        headers as needed. </td>
                </tr>
                
                <tr>
                    <td>
                        <para>IP Identity</para>
                    </td>
                    <td>
                        <para>ip-identity</para>
                    </td>
                    <td>
                        <para>ip-identity-configuration.xsd</para>
                    </td>
                    <td>
                        <para>ip-identity.cfg.xml</para>
                    </td>
                    <td>
                        <para>Enables Repose to  introspect a
                            request's source IP and set the X-PP-User
                            and X-PP-Groups headers as needed. </para>
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <para>URI Identity</para>
                    </td>
                    <td>
                        <para>uri-identity</para>
                    </td>
                    <td>
                        <para>uri-identity-configuration.xsd</para>
                    </td>
                    <td>
                        <para>uri-identity.cfg.xml</para>
                    </td>
                    <td>
                        <para>Enables Repose to  inspect a request URI
                            and set the X-PP-User and X-PP-Group
                            headers as needed. </para>
                    </td>
                </tr>
                
                <tr>
                    <td><para><link linkend="Repose-Ratelimiting-Chapter"
                        >Ratelimiting</link></para></td>
                    
                    <td>
                        
                        <link xlink:href="https://github.com/rackerlabs/repose/blob/master/repose-aggregator/components/filters/rate-limiting/src/main/resources/META-INF/schema/examples/rate-limiting.cfg.xml"> 
                            rate-limiting.cfg.xml</link> 
                    </td>
                    <td>
                        <link xlink:href="https://github.com/rackerlabs/repose/blob/master/repose-aggregator/components/filters/rate-limiting/src/main/resources/META-INF/schema/examples/rate-limiting.cfg.xml"> 
                            rate-limiting.cfg.xml</link> 
                    </td>
                    <td>
                        <para>Gives configurable control over the
                            amount of traffic to the origin service.</para>
                    </td>
                </tr>
                
                
                
            </tbody>
        </table>
    <xi:include href="chapters/repose-ratelimiting-chapter.xml"/>
    </chapter>
    
    
    
    <!-- AUTHENTICATION FILTERS --> 
   
    <chapter xml:id="authentication-filters">
        <title>Authentication Filters</title>
        <para>The Authentication filters authenticate and authorize requests to the origin service. 
            These filters authenticate requests before they are passed to the origin service, validate 
            requests before they are passed through the filter chain, and send basic authentication 
            credentials to the origin service.  To see the basic functions that these filters perform, 
            read through each filter description in the table below.</para>
        <table rules="all" frame="box" border="1">
            <?dbfo keep-together="always"?>
            <caption>Authentication Filters</caption>
            <thead>
                <tr>
                    <td>Filter Name</td>
                    <td>filter-name</td>
                    <td>XML Schema Definition</td>
                    <td>Example Configuration</td>
                    <td>Description</td>
                    
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><para><link linkend="Repose-AuthNZ-Chapter"
                        >Client Authentication</link></para></td>
                    <td>
                        <para>client-auth</para>
                    </td>
                    <td>
                        <link xlink:href="https://github.com/rackerlabs/repose/blob/master/repose-aggregator/components/filters/client-auth/src/main/resources/META-INF/schema/config/client-auth-n-configuration.xsd"> 
                            client-auth-n-configuration.xsd</link> 
                    </td>
                    <td>
                        <link xlink:href="https://github.com/rackerlabs/repose/blob/master/repose-aggregator/components/filters/client-auth/src/main/resources/META-INF/schema/examples/openstack/client-auth-n.cfg.xml"> 
                            client-auth-n.cfg.xml</link> 
                    </td>
                    <td>
                        <para>Acting as a reverse proxy, this filter
                            can be configured to use an identity
                            endpoint to authenticate an HTTP request
                            before  the request is passed to the
                            origin server.   </para>
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <para>- OpenStack Identity Service</para>
                    </td>
                    <td>
                        <para>content-identity-auth-2.0</para>
                    </td>
                    <td>
                        <para>openstack-ids-auth.xsd</para>
                    </td>
                    <td>
                        <para>client-auth-n.cfg.xml</para>
                    </td>
                    <td>The Repose client authentication component
                        supports an OpenStack Identity Service
                        authentication scheme. For example, the Repose
                        client authentication component may be
                        configured to interact with Keystone or Cloud
                        Auth 2.0 (both of which implement the
                        OpenStack Identity Service contract) when
                        validating user credentials. </td>
                </tr>
                
                <tr>
                    <td>
                        <para>- Rackspace Cloud Auth 1.1</para>
                    </td>
                    <td>
                        <para>content-identity-auth-1.1</para>
                    </td>
                    <td>
                        <para>rackspace-auth-v1.1.xsd</para>
                    </td>
                    <td>
                        <para>client-auth-n.cfg.xml</para>
                    </td>
                    <td>
                        <para>The Repose client authentication
                            component supports the Rackspace Cloud
                            Auth 1.1 authentication scheme. </para>
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <para>Client Authorization</para>
                    </td>
                    <td>
                        <para>client-authorization</para>
                    </td>
                    <td>
                        <para>openstack-authorization-configuration.xsd</para>
                    </td>
                    <td>
                        <para>openstack-authorization.cfg.xml</para>
                    </td>
                    <td>
                        <para>This filter can be configured to
                            validate that a client request is allowed.
                            If the request is allowed, it proceeds
                            through the filter chain, on to the origin
                            service. If the request is not allowed,
                            the request will be denied with an  <link
                                xlink:href="http://tools.ietf.org/html/rfc2616#section-10.4.4"
                                >HTTP 500 - Internal Server
                                Error</link> response. </para>
                    </td>
                </tr>
                
                <tr>
                    <td>Service Authentication</td>
                    <td>
                        <para>service-authentication</para>
                    </td>
                    <td>
                        <para>service-auth-configuration.xsd</para>
                    </td>
                    <td>
                        <para>service-authentication.cfg.xml</para>
                    </td>
                    <td>
                        <para>This filter sends basic authentication
                            credentials up to the origin service. </para>
                    </td>
                </tr>
                
                
                
            </tbody>
        </table>
    <xi:include href="chapters/repose-authnauthz-chapter.xml"/>
</chapter>
    
   
   
   
   
    <!-- OTHER FILTERS --> 
    
    <chapter xml:id="other-filters">
    <title>Other Filters</title>
        <para>The filters in this section perform many tasks that are unrelated to each other, 
            such as logging, validating, compressing or decompressing, and versioning request 
            information. To see the basic functions that these filters perform, read through 
            each filter description in the table below.</para>
        
        <table rules="all" frame="box" border="1">
            <?dbfo keep-together="always"?>
            <caption>Authentication Filters</caption>
            <thead>
                <tr>
                    <td>Filter Name</td>
                    <td>filter-name</td>
                    <td>XML Schema Definition</td>
                    <td>Example Configuration</td>
                    <td>Description</td>
                    
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <para>
                            <link linkend="Repose-API-Validation-Chapter"
                                >API (WADL/XSD) Validation</link>
                        </para>
                       
                    </td>
                    <td>
                        <para>api-validator</para>
                    </td>
                    <td>
                        <para>validator-configuration.xsd</para>
                    </td>
                    <td>
                        <para>validator.cfg.xml</para>
                    </td>
                    <td>
                        <para>Validates all requests based on an XSD
                            and WADL.  </para>
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <para>
                            <link linkend="HTTP-Logging-Filter">HTTP
                                Logging</link>
                        </para>
                        
                    </td>
                    <td>
                        <para>http-logging</para>
                    </td>
                    <td>
                        <para>http-logging-configuration.xsd</para>
                    </td>
                    <td>
                        <para>http-logging.cfg.xml</para>
                    </td>
                    <td>Allows logging of information in HTTP requests
                        that are sent to Repose and responses from
                        Repose. </td>
                </tr>
                
                <tr>
                   
                    <td>
                    <para>
                        <link linkend="Repose-Compression-Chapter"
                        >Compression</link>
                    </para>
                    </td>
                    <td>
                        <para>compression</para>
                    </td>
                    <td>
                        <para>content-compression-configuration.xsd</para>
                    </td>
                    <td>
                        <para>compression.cfg.xml</para>
                    </td>
                    <td>
                        <para>With this filter, Repose supports
                            decompressing request data and compressing
                            response data. This filter is available in
                            Repose versions 2.7 and later. </para>
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <para>
                            <link linkend="Repose-Versioning-Chapter"
                                >Versioning </link>
                        </para>
                        
                    </td>
                    <td>
                        <para>versioning</para>
                    </td>
                    <td>
                        <para>versioning-configuration.xsd</para>
                    </td>
                    <td>
                        <para>versioning.cfg.xml</para>
                    </td>
                    <td>
                        <para>Enables REST services to version updates
                            without causing end-client breakage.  </para>
                    </td>
                </tr>
                
                <tr>
                    <td> Destination Router</td>
                    <td>
                        <para>destination-router</para>
                    </td>
                    <td>
                        <para>destination-router-configuration.xsd</para>
                    </td>
                    <td>
                        <para>destination-router.cfg.xml</para>
                    </td>
                    <td>Adds a routing destination at a configured
                        quality. After the request has been processed
                        by all filters,  Repose chooses the
                        destination that has the highest quality.
                        Available in Repose versions 2.0 and later. </td>
                </tr>
                
                <tr>
                    <td> Flush Output Stream</td>
                    <td>
                        <para> flush-output </para>
                    </td>
                    <td>
                        <para>Coming soon!</para>
                    </td>
                    <td>
                        <para>Coming soon!</para>
                    </td>
                    <td>
                        <para>Forces Repose to flush any data buffered
                            in the filter chain to the output stream.  </para>
                    </td>
                </tr>
                
                
                
            </tbody>
        </table>
    <xi:include href="chapters/repose-logging-chapter.xml"/> 
    <xi:include href="chapters/repose-versioning-chapter.xml"/>
    <xi:include href="chapters/repose-apivalidation-chapter.xml"/>
    <xi:include href="chapters/repose-compression-chapter.xml"/>  
    </chapter>
   
   
    <!-- 
    <chapter xml:id="glossary">
        <title>Glossary</title>
    <xi:include href="chapters/repose-glossary-chapter.xml"/>
    </chapter>
    
    
    <chapter xml:id="afterward">
        <title>Afterward</title>
    <xi:include href="chapters/afterword.xml"/> 
    </chapter>
    -->
</book>
